os.pullEvent = os.pullEventRaw

function setcurruser(user)
  fs.delete("/rtos/users/curruser")
  local curruser = fs.open("/rtos/users/curruser","w")
  curruser.writeLine(user)
  curruser.close()
end

write("Please Login")
write("User: ")
local user = read()
if fs.isDir("/rtos/users/"..user) == false then
  write("That user does not exist!")
  shell.run("login")
else
  local userpassget = fs.open("/rtos/users/"..user.."/pass", "r")
  local userpass = userpassget.readAll()
  write("Pass: ")
  local pass = read("*")
  if pass ~= userpass then
    write("Wrong Password!")
	shell.run("login")
  else
    write("Logged In!")
	setcurruser(user)
	shell.run("/rtos/rtshell")
  end
end