os.pullEvent = os.pullEventRaw

function setcurruser(user)
  fs.delete("/rtos/users/curruser")
  local curruser = fs.open("/rtos/users/curruser","w")
  curruser.writeLine(user)
  curruser.close()
end

rtos.Println(1,15,"Please Login")
rtos.Println(1,16,"User: ")
local user = read()
if fs.isDir("/rtos/users/"..user) == false then
  rtos.Println(1,17,"That user does not exist!")
  shell.run("login")
else
  local userpassget = fs.open("/rtos/users/"..user.."/pass", "r")
  local userpass = userpassget.readAll()
  rtos.Println(1,17,"Pass: ")
  local pass = read("*")
  if pass ~= userpass then
    rtos.Println(1,18,"Wrong Password!")
	   shell.run("/rtos/users/login")
  else
    rtos.Println(1,18,"Logged In!")
	setcurruser(user)
	shell.run("/rtos/rtshell")
  end
end
